<!DOCTYPE html>
<html lang="en">
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Letter to LAMIA</title>
      <link href='http://fonts.googleapis.com/css?family=Cabin:400,700' rel='stylesheet' type='text/css'>
      <script type="text/javascript" src="/static/d3.min.js"></script>
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
      <style>

        body {
          font-family: 'Cabin', sans-serif;
          font-size: 12px;
          background-color: #fefefe;
          height: 100%;
          margin: 0;
          overflow: hidden;
        }

        #svg {
          width: 100%;
          height: 100%;
          position: absolute;
        }

        svg text {
          pointer-events: none;
        }

        path {
          fill: none;
          stroke: #000;
          stroke-width: 3px;
        }

        .div {
          position: absolute;
          left: 0;
          right: 0;
          margin-left: auto;
          margin-right: auto;
          z-index: 3;
          background-color: yellow;
        }

        .button {
          cursor: pointer;
        }

        #myStory_button:hover {
          fill: blue;
        }

        #myCv_button:hover {
          fill: red;
        }

        #myPortfolio_button:hover {
          fill: yellow;
        }

        @media (max-width: 820px) {

          #toLamia {
            font-size: 35px;
          }

          #fromMoon {
            font-size: 35px;
          }

          #letterDate {
            font-size: 35px;
          }

          .button {
            width: 50px;
            height: 25px;
          }

        }


      </style>
    </head>
    <body>

    <svg id="svg"></svg>

      <script>

      var width = parseInt(d3.select("#svg").style("width"));
      var height = parseInt(d3.select("#svg").style("height"));


      var points = [
        [width/5, height/7.8],
        [width/1.23, height/7.8],
        [width/1.23, height/1.2],
        [width/5, height/1.2],
        [width/5, height/3.2],
        [width/4, height/4.3],
        [width/5, height/7.8]
      ];

      var xScale = d3.scale.linear()
                            .domain([0, d3.max(points, function(d) { return d[0]; })])
                            .range([0, width]);

      var yScale = d3.scale.linear()
                            .domain([0, d3.max(points, function(d) { return d[1]; })])
                            .range([0, height]);


      var line = d3.svg.line()
          .tension(0) // Catmullâ€“Rom
          .interpolate("linear");

      var svg = d3.select("#svg")
          .data([points])
          .attr("width", width)
          .attr("height", height);

      var myStory_button = svg.append("rect")
          .attr("class", "button")
          .attr("id", "myStory_button")
          .attr("x", width/1.225)
          .attr("y", height/5)
          .attr("width", width/16)
          .attr("height", height/17)
          .attr("fill", "green")
          .attr("stroke-width", 10)
          .attr("stroke", "black")
          .on("click", function() {
            d3.select("#myCv_button")
              .attr("stroke-width", 0);
            d3.select("#myPortfolio_button")
              .attr("stroke-width", 0);
            d3.select(this)
              .attr("stroke-width", 10)
              .attr("stroke", "black");
            d3.select("#div_top")
              .html("<span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sit amet arcu efficitur nulla facilisis malesuada. Mauris lacus eros, dapibus in aliquam in, faucibus non est. Quisque massa magna, iaculis vel elit at, bibendum ullamcorper elit. Suspendisse potenti. Sed ut sapien ut nulla bibendum maximus eget non ante. Fusce malesuada lacus sed metus molestie, eget interdum lacus facilisis. Praesent mollis scelerisque neque finibus efficitur. Vivamus varius viverra risus pharetra eleifend. Sed eget sapien ac lacus dignissim luctus. Interdum et malesuada fames ac ante ipsum primis in faucibus. </span>");
            d3.select("#div_bottom")
              .text("Story");
          });

      var myStory_text = svg.append("text")
                              .attr("x", width/1.21)
                              .attr("y", height/4.3)
                              .attr("font-size", 14)
                              .attr("font-weight", "bold")
                              .attr("fill", "black")
                              .text("STORY");

      var myCv = svg.append("rect")
          .attr("class", "button")
          .attr("id", "myCv_button")
          .attr("x", width/1.225)
          .attr("y", height/3.5)
          .attr("width", width/16)
          .attr("height", height/17)
          .attr("fill", "orange")
          .on("click", function() {
            d3.select("#myStory_button")
              .attr("stroke-width", 0);
            d3.select("#myPortfolio_button")
              .attr("stroke-width", 0);
            d3.select(this)
              .attr("stroke-width", 10)
              .attr("stroke", "black");
            d3.select("#div_top")
              .text("CV");
            d3.select("#div_bottom")
              .text("CV");
          });

      var myCv_text = svg.append("text")
                              .attr("x", width/1.21)
                              .attr("y", height/3.1)
                              .attr("font-size", 14)
                              .attr("font-weight", "bold")
                              .attr("fill", "black")
                              .text("CV");

      var myPortfolio = svg.append("rect")
          .attr("class", "button")
          .attr("id", "myPortfolio_button")
          .attr("x", width/1.225)
          .attr("y", height/2.7)
          .attr("width", width/16)
          .attr("height", height/17)
          .attr("fill", "purple")
          .on("click", function() {
            d3.select("#myStory_button")
              .attr("stroke-width", 0);
            d3.select("#myCv_button")
              .attr("stroke-width", 0);
            d3.select(this)
              .attr("stroke-width", 10)
              .attr("stroke", "black");
            d3.select("#div_top")
              .text("PP");
            d3.select("#div_bottom")
              .text("PP");
          });


      var myPortfolio_text = svg.append("text")
                              .attr("x", width/1.21)
                              .attr("y", height/2.46)
                              .attr("font-size", 14)
                              .attr("font-weight", "bold")
                              .attr("fill", "black")
                              .text("PP");

      svg.append("path")
          .style("stroke", "#ddd")
          .style("stroke-dasharray", "10,10")
          .style("stroke-width", "10")
          .attr("d", line);

      svg.append("path")
          .attr("d", line)
          .style("stroke-width", "10")
          .call(transition);

      var div_top = d3.select("body").append("div")
                    .attr("class", "div")
                    .attr("id", "div_top")
                    .style("width", width - width/3.8 * 2 + "px")
                    .style("height", height - height/1.2 + "px")
                    .style("margin-top", height/6.7 + "px")
                    .html("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sit amet arcu efficitur nulla facilisis malesuada. Mauris lacus eros, dapibus in aliquam in, faucibus non est. Quisque massa magna, iaculis vel elit at, bibendum ullamcorper elit. Suspendisse potenti. Sed ut sapien ut nulla bibendum maximus eget non ante. Fusce malesuada lacus sed metus molestie.");

      var div_bottom = d3.select("body").append("div")
                    .attr("class", "div")
                    .attr("id", "div_bottom")
                    .style("width", width - width/4.7 * 2 + "px")
                    .style("height", height - height/1.95 + "px")
                    .style("margin-top", height/3 + "px")
                    .text("Story");


      var toLamia = svg.append("text")
                        .attr("id", "toLamia")
                        .attr("x", width/5.1)
                        .attr("y", height/8.7)
                        .attr("font-size", 60)
                        .attr("font-weight", "bold")
                        .text("To LAMIA");

      var fromMoon = svg.append("text")
                        .attr("id", "fromMoon")
                        .attr("x", width/1.22)
                        .attr("y", height/1.11)
                        .attr("font-size", 60)
                        .attr("font-weight", "bold")
                        .attr("text-anchor", "end")
                        .text("From MOON");

      var letterDate = svg.append("text")
                        .attr("id", "letterDate")
                        .attr("x", width/5.1)
                        .attr("y", height/1.11)
                        .attr("font-size", 60)
                        .attr("font-weight", "bold")
                        .text("21/06/2015");

      function transition(path) {
        path.transition()
            .duration(3000)
            .attrTween("stroke-dasharray", tweenDash);
           // .each("end", function() { d3.select(this).call(transition); });
      }

      function tweenDash() {
        var l = this.getTotalLength(),
            i = d3.interpolateString("0," + l, l + "," + l);
        return function(t) { return i(t); };
      }


      function resize() {
        var width = parseInt(d3.select("#svg").style("width")),
        height = parseInt(d3.select("#svg").style("height"));

      var points = [
        [width/5, height/7.8],
        [width/1.23, height/7.8],
        [width/1.23, height/1.2],
        [width/5, height/1.2],
        [width/5, height/3.2],
        [width/4, height/4.3],
        [width/5, height/7.8]
      ];

      var svg = d3.select("#svg")
          .data([points])
          .attr("width", width)
          .attr("height", height);

      }
       

      d3.select(window).on('resize', resize); 

      resize();

      $(window).resize(function(){
        window.location.replace( window.location.href );
      });

      </script>
    </body>
</html>